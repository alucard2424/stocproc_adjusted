

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>StocProc_FFT &mdash; StocProc 0.2.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="StocProc 0.2.0 documentation" href="index.html"/>
        <link rel="up" title="Stochastic Process Generators" href="stocproc.html"/>
        <link rel="next" title="Example" href="example.html"/>
        <link rel="prev" title="StocProc_KLE" href="StocProc_KLE.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> StocProc
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="stocproc.html">Stochastic Process Generators</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="stocproc.html#karhunen-loeve-expansion">Karhunen-Loève expansion</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="stocproc.html#fast-fourier-method">Fast-Fourier method</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">StocProc_FFT</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">StocProc</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="stocproc.html">Stochastic Process Generators</a> &raquo;</li>
      
    <li>StocProc_FFT</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/StocProc_FFT.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stocproc-fft">
<h1>StocProc_FFT<a class="headerlink" href="#stocproc-fft" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="stocproc.stocproc.StocProc_FFT">
<em class="property">class </em><code class="descclassname">stocproc.stocproc.</code><code class="descname">StocProc_FFT</code><span class="sig-paren">(</span><em>spectral_density</em>, <em>t_max</em>, <em>bcf_ref</em>, <em>intgr_tol=0.01</em>, <em>intpl_tol=0.01</em>, <em>seed=None</em>, <em>negative_frequencies=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stocproc/stocproc.html#StocProc_FFT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stocproc.stocproc.StocProc_FFT" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate Stochastic Process using FFT method</p>
<p>This method uses the relation of the auto correlation to the spectral density</p>
<div class="math">
\[\alpha(\tau) = \int \mathrm{d}\omega \, \frac{J(\omega)}{\pi} e^{-\mathrm{i}\omega \tau}\]</div>
<p>where <span class="math">\(J(\omega)\)</span> is a real non negative function, usually called spectral density.
Then the integral can be approximated by a discrete integration scheme:</p>
<div class="math">
\[\alpha(\tau) \approx \sum_{k=0}^{N-1} w_k \frac{J(\omega_k)}{\pi} e^{-\mathrm{i} k \omega_k \tau}\]</div>
<p>where the <span class="math">\(\omega_k\)</span> depend on the integration scheme.</p>
<p>For a process defined by</p>
<div class="math">
\[Z(t) = \sum_{k=0}^{N-1} \sqrt{\frac{w_k J(\omega_k)}{\pi}} Y_k \exp^{-\mathrm{i}\omega_k t}\]</div>
<p>with independent complex random variables <span class="math">\(Y_k\)</span> such that <span class="math">\(\langle Y_k \rangle = 0\)</span>,
<span class="math">\(\langle Y_k Y_{k'}\rangle = 0\)</span> and <span class="math">\(\langle Y_k Y^\ast_{k'}\rangle = \Delta \omega \delta_{k,k'}\)</span>
it is easy to see that its auto correlation function will be exactly the approximated auto correlation function.</p>
<div class="math">
\[\begin{split}\begin{align}
    \langle Z(t) Z^\ast(s) \rangle = &amp; \sum_{k,k'} \frac{1}{\pi} \sqrt{w_k w_{k'} J(\omega_k)J(\omega_{k'})} \langle Y_k Y_{k'}\rangle \exp(-\mathrm{i}(\omega_k t - \omega_k' s)) \\
                                   = &amp; \sum_{k}    \frac{w_k}{\pi} J(\omega_k) e^{-\mathrm{i}\omega_k (t-s)} \\
                                   \approx &amp; \alpha(t-s)
\end{align}\end{split}\]</div>
<p>To calculate <span class="math">\(Z(t)\)</span> the Discrete Fourier Transform (DFT) can be applied as follows:</p>
<div class="math">
\[Z(t_l) = e^{-\mathrm{i}\omega_\mathrm{min} t_l} \sum_{k=0}^{N-1} \sqrt{\frac{w_k J(\omega_k)}{\pi}} Y_k  e^{-\mathrm{i} 2 \pi \frac{k l}{N} \frac{\Delta \omega \Delta t}{ 2 \pi} N}\]</div>
<p>Here <span class="math">\(\omega_k\)</span> has to take the form <span class="math">\(\omega_k = \omega_\mathrm{min} + k \Delta \omega\)</span> and
<span class="math">\(\Delta \omega = (\omega_\mathrm{max} - \omega_\mathrm{min}) / N-1\)</span> which limits
the itegration schemes to those with equidistant weights.
For the DFT scheme to be applicable <span class="math">\(\Delta t\)</span> has to be chosen such that</p>
<div class="math">
\[1 = \frac{\Delta \omega \Delta t}{2 \pi} N\]</div>
<p>holds. Since <span class="math">\(J(\omega)\)</span> is real it follows that <span class="math">\(X(t_l) = X^\ast(t_{N-l})\)</span>.
For that reason the stochastic process has only <span class="math">\((N+1)/2\)</span> (odd <span class="math">\(N\)</span>) and
<span class="math">\((N/2 + 1)\)</span> (even <span class="math">\(N\)</span>) independent time grid points.</p>
<div class="math">
\[Z_l = e^{-\mathrm{i}\omega_\mathrm{min} t_l} DFT\left(\sqrt{w_k J(\omega_k) / \pi} \; Y_k\right) \qquad k = 0 \; ... \; N-1, \quad l = 0 \; ... \; n\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spectral_density</strong> &#8211; the spectral density <span class="math">\(J(\omega)\)</span> as callable function object</li>
<li><strong>t_max</strong> &#8211; <span class="math">\([0,t_\mathrm{max}]\)</span> is the interval for which the process will be calculated</li>
<li><strong>num_grid_points</strong> &#8211; number <span class="math">\(n\)</span> of euqally distributed times <span class="math">\(t_k\)</span> on the intervall <span class="math">\([0,t_\mathrm{max}]\)</span>
for which the process will be evaluated</li>
<li><strong>num_samples</strong> &#8211; number of independent processes to be returned</li>
<li><strong>seed</strong> &#8211; seed passed to the random number generator used</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns the tuple (2D array of the set of stochastic processes,
1D array of time grid points). Each row of the stochastic process
array contains one sample of the stochastic process.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="example.html" class="btn btn-neutral float-right" title="Example" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="StocProc_KLE.html" class="btn btn-neutral" title="StocProc_KLE" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Richard Hartmann.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>